---
import Tokens from "csrf";

const tokens = new Tokens();

const state = tokens.create(process.env.CSRF_SECRET);

const params = new URLSearchParams({
  client_id: process.env.TWITCH_CLIENT_ID,
  force_verify: "true",
  redirect_uri: "https://localhost:4321",
  response_type: "token",
  scope: "moderator:read:chatters",
  state,
});
---

<!doctype html>
<html>
  <head></head>
  <body>
    <a href={`https://id.twitch.tv/oauth2/authorize?${params}}`}>Authorize</a>
    <canvas data-client-id={process.env.TWITCH_CLIENT_ID}></canvas>
    <script>
      import "../game";
    </script>
  </body>
</html>
